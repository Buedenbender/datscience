<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The Idea was inspired by a blog post of my colleague Remi Theriault
(see remi-theriault.com)
Which utilized the ability of flextable to be able to get an
APA-style formatted table directly from R into .docx (word). One frequent use case
is to get a correlation table into word. For the creation of the correlation table
this function uses the corstars function from this package, which
resolves around the code by
Dominik Vogel.
I built on those idea and created a function that creates a pretty correlation table
together with the summary stats of your choice, and returns a flextable, which
can be easily exported to word (see also  save_flextable)
Please note:
This function only considers numeric variables (cols). Other
datatypes will be dropped from the data.frame df.
There is an interaction between the arguments sig.level and nod.
When sig.level is set to NA, this improves the formatting of decimals places in the finale table,
and removes the stars marking significance. However, this also prevents the table from having
differing number of decimal places. Meaning the number of decimals for the correlation will also determine
the number of decimals for the summary statistics

"><title>Create APA Publication Ready Correlation Table and Export to Word or Powerpoint — apa_corrTable • datscience</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create APA Publication Ready Correlation Table and Export to Word or Powerpoint — apa_corrTable"><meta property="og:description" content="The Idea was inspired by a blog post of my colleague Remi Theriault
(see remi-theriault.com)
Which utilized the ability of flextable to be able to get an
APA-style formatted table directly from R into .docx (word). One frequent use case
is to get a correlation table into word. For the creation of the correlation table
this function uses the corstars function from this package, which
resolves around the code by
Dominik Vogel.
I built on those idea and created a function that creates a pretty correlation table
together with the summary stats of your choice, and returns a flextable, which
can be easily exported to word (see also  save_flextable)
Please note:
This function only considers numeric variables (cols). Other
datatypes will be dropped from the data.frame df.
There is an interaction between the arguments sig.level and nod.
When sig.level is set to NA, this improves the formatting of decimals places in the finale table,
and removes the stars marking significance. However, this also prevents the table from having
differing number of decimal places. Meaning the number of decimals for the correlation will also determine
the number of decimals for the summary statistics

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">datscience</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ScreePlot_ConfidenceIntervalls_ForObservedEigenvalues.html">Pretty Scree Plot with CIs for Eigenvalues </a>
    <a class="dropdown-item" href="../articles/flex_table1.html">A Guide to Bivariate Table 1</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Buedenbender/datscience/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create APA Publication Ready Correlation Table and Export to Word or Powerpoint</h1>
      <small class="dont-index">Source: <a href="https://github.com/Buedenbender/datscience/blob/HEAD/R/apa_corrTable.R" class="external-link"><code>R/apa_corrTable.R</code></a></small>
      <div class="d-none name"><code>apa_corrTable.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The Idea was inspired by a blog post of my colleague Remi Theriault
(see <a href="https://remi-theriault.com/blog_table.html" class="external-link">remi-theriault.com</a>)
Which utilized the ability of <code><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></code> to be able to get an
APA-style formatted table directly from R into .docx (word). One frequent use case
is to get a correlation table into word. For the creation of the correlation table
this function uses the <code><a href="corstars.html">corstars</a></code> function from this package, which
resolves around the code by
<a href="https://rdrr.io/github/DominikVogel/vogelR/src/R/output.R" class="external-link">Dominik Vogel</a>.<br>
I built on those idea and created a function that creates a pretty correlation table
together with the summary stats of your choice, and returns a flextable, which
can be easily exported to word (see also  <code><a href="save_flextable.html">save_flextable</a></code>)<br><strong>Please note:</strong></p><ul><li><p>This function only considers numeric variables (cols). Other
datatypes will be dropped from the data.frame df.</p></li>
<li><p>There is an interaction between the arguments <code>sig.level</code> and <code>nod</code>.
When sig.level is set to NA, this improves the formatting of decimals places in the finale table,
and removes the stars marking significance. However, this also prevents the table from having
differing number of decimal places. Meaning the number of decimals for the correlation will also determine
the number of decimals for the summary statistics</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">apa_corrTable</span><span class="op">(</span>
  <span class="va">df</span>,
  summarystats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"spearman"</span>, <span class="st">"polychoric"</span><span class="op">)</span>,
  rmDiag <span class="op">=</span> <span class="cn">FALSE</span>,
  sig.level <span class="op">=</span> <span class="fl">0.05</span>,
  nod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
  filepath <span class="op">=</span> <span class="cn">NA</span>,
  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>Data.frame, mandatory argument. Consider filtering before passing it
e.g. with dplyr::select() and dplyr::filter()</p></dd>
<dt>summarystats</dt>
<dd><p>A vector with the summary stats to be included at the bottom
below the correlation. <br> Default is <code>c("mean","sd")</code>
Options are one or all of <code>c("mean","sd","median","range","min","max","skew",
"kurtosis","se","missing")</code>. The option "missing", adds missings per item as additional row
(accecpts both "missing" and "missings", spelling in table accordingly).
If NA is given, no summarystats will be added.</p></dd>
<dt>method</dt>
<dd><p>Type of correlation. Options are currently: "pearson", "spearman" and "polychoric"</p></dd>
<dt>rmDiag</dt>
<dd><p>Should the diagonal in the corr matrix kept (FALSE) or removed (TRUE)</p></dd>
<dt>sig.level</dt>
<dd><p>How many stars per level of significance, options include
.05 .01 or .001. If NA no stars indicating significance will be output. This improves
formatting of decimals in the table. Note the default for polychoric is NA</p></dd>
<dt>nod</dt>
<dd><p>(Optional) Integer or Integer Vector. Number of Decimals.
In case of -1 a simple convention based on sample size is applied for determination
of number of decimal points. See <code><a href="get_number_of_decimals.html">get_number_of_decimals</a></code>.
You can also provide an Integer vector, if you want different number of decimals
for the correlations and the summary stats. The first integer determines nod for
correlations, the second for summary stats. E.g., <code>nod = c(2,-1)</code> would give 2 decimals
for correlations and apply the convention for summary stats. Default is <code>nod = c(2,-1)</code>. <br>
See <code><a href="get_number_of_decimals.html">get_number_of_decimals</a></code> or<code><a href="get_number_of_decimals.html">?datscience::get_number_of_decimals</a></code></p></dd>
<dt>filepath</dt>
<dd><p>(Optional) Path and filename were the APA ready table should
be saved, options include the common filetypes .docx (Word), .pptx (Powerpoint),
.html (Webpage). Default is <code>filepath = NA</code>. If NA is given, no file will be saved.</p></dd>
<dt>overwrite</dt>
<dd><p>(Optional) Boolean, default is FALSE. When overwrite is
FALSE and the files already exists, a serialized version of the filename
will be created (i.e., appending _001, or _002). Utilizes <code><a href="serialNext.html">serialNext</a></code></p></dd>
<dt>...</dt>
<dd><p>(Optional), Additional arguments that can be passed to <code><a href="format_flextable.html">format_flextable</a></code>
(e.g., fontsize, font ...) or to <code><a href="serialNext.html">serialNext</a></code></p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></code> object with APA ready correlation table.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_number_of_decimals.html">get_number_of_decimals</a></code>, <code><a href="format_flextable.html">format_flextable</a></code>,
<code><a href="serialNext.html">serialNext</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bjoern Buedenbender (Formatting based on Remi Theriault,
Correlations based on Dominik Vogel)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Buedenbender/datscience/" class="external-link">datscience</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu">apa_corrTable</span><span class="op">(</span><span class="va">mtcars</span>, table_caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Table 2"</span>, <span class="st">"Correlations in the mtcars Data Set"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a flextable object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> col_keys: ` `, `mpg`, `cyl`, `disp`, `hp`, `drat`, `wt`, `qsec`, `vs`, `am`, `gear`, `carb` </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> header has 3 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> body has 13 row(s) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> original dataset sample: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mpg       cyl      disp        hp   drat wt qsec vs am gear carb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  mpg     1.00                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  cyl -0.85***      1.00                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 disp -0.85***   0.90***      1.00                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   hp -0.78***   0.83***   0.79***      1.00                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 drat  0.68***  -0.70***  -0.71***  -0.45**    1.00                         </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Björn Büdenbender.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

